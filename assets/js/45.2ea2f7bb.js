(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{686:function(e,s,r){"use strict";r.r(s);var t=r(16),a=Object(t.a)({},(function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"_2-3-centos"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-centos"}},[e._v("#")]),e._v(" 2.3 CentOS")]),e._v(" "),r("h2",{attrs:{id:"_1-获取适用于-centos-的-docker-ce"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取适用于-centos-的-docker-ce"}},[e._v("#")]),e._v(" 1. 获取适用于 CentOS 的 Docker CE")]),e._v(" "),r("p",[e._v("如需开始在 CentOS 上使用 Docker CE，请确保您"),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#prerequisites",target:"_blank",rel:"noopener noreferrer"}},[e._v("满足先决条件"),r("OutboundLink")],1),e._v("，然后再"),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#install-docker",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装 Docker"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("h2",{attrs:{id:"_2-先决条件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-先决条件"}},[e._v("#")]),e._v(" 2. 先决条件")]),e._v(" "),r("h3",{attrs:{id:"_2-1-docker-ee-客户"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-docker-ee-客户"}},[e._v("#")]),e._v(" 2.1. Docker EE 客户")]),e._v(" "),r("p",[e._v("如需安装 Docker 企业版 (Docker EE)，请转至"),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ee/centos/",target:"_blank",rel:"noopener noreferrer"}},[e._v("获取适用于 CentOS 的 Docker EE"),r("OutboundLink")],1),e._v(" "),r("strong",[e._v("而不是本主题")]),e._v("。")]),e._v(" "),r("p",[e._v("如需了解有关 Docker EE 的更多信息，请参阅 "),r("a",{attrs:{href:"https://www.docker.com/enterprise-edition/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker 企业版"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("h3",{attrs:{id:"_2-2-操作系统要求"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-操作系统要求"}},[e._v("#")]),e._v(" 2.2. 操作系统要求")]),e._v(" "),r("p",[e._v("如需安装 Docker CE，您需要 64 位版本的 CentOS 7。")]),e._v(" "),r("h3",{attrs:{id:"_2-3-卸载旧版本"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-卸载旧版本"}},[e._v("#")]),e._v(" 2.3. 卸载旧版本")]),e._v(" "),r("p",[e._v("Docker 的早期版本称为 "),r("code",[e._v("docker")]),e._v(" 或 "),r("code",[e._v("docker-engine")]),e._v("。如果安装了这些版本，请卸载它们及关联的依赖资源。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum remove docker \\\n                  docker-common \\\n                  docker-selinux \\\n                  docker-engine\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br")])]),r("p",[e._v("如果 "),r("code",[e._v("yum")]),e._v(" 报告未安装任何这些软件包，这表示情况正常。")]),e._v(" "),r("p",[e._v("将保留 "),r("code",[e._v("/var/lib/docker/")]),e._v(" 的内容，包括镜像、容器、存储卷和网络。Docker CE 软件包现在称为 "),r("code",[e._v("docker-ce")]),e._v("。")]),e._v(" "),r("h2",{attrs:{id:"_3-安装-docker-ce"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装-docker-ce"}},[e._v("#")]),e._v(" 3. 安装 Docker CE")]),e._v(" "),r("p",[e._v("您可以通过不同方式安装 Docker CE，具体取决于您的需求：")]),e._v(" "),r("ul",[r("li",[e._v("大多数用户"),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#install-using-the-repository",target:"_blank",rel:"noopener noreferrer"}},[e._v("设置 Docker 的镜像仓库"),r("OutboundLink")],1),e._v("并从中进行安装，从而可以轻松完成安装和升级任务。这是推荐方法。")]),e._v(" "),r("li",[e._v("一些用户下载 RPM 软件包并手动进行安装，然后完全由手动管理升级。在某些情况（例如，在不能访问互联网的隔离系统中安装 Docker）下，这很有用。")])]),e._v(" "),r("h3",{attrs:{id:"_3-1-使用镜像仓库进行安装"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-使用镜像仓库进行安装"}},[e._v("#")]),e._v(" 3.1. 使用镜像仓库进行安装")]),e._v(" "),r("p",[e._v("首次在新的主机上安装 Docker CE 之前，您需要设置 Docker 镜像仓库。然后，您可以从此镜像仓库安装和更新 Docker。")]),e._v(" "),r("ol",[r("li",[e._v("设置镜像仓库")])]),e._v(" "),r("p",[e._v("安装所需的软件包。"),r("code",[e._v("yum-utils")]),e._v(" 提供了 "),r("code",[e._v("yum-config-manager")]),e._v(" 实用程序，并且 "),r("code",[e._v("devicemapper")]),e._v(" 存储驱动需要"),r("code",[e._v("device-mapper-persistent-data")]),e._v(" 和 "),r("code",[e._v("lvm2")]),e._v("。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("使用下列命令设置 "),r("strong",[e._v("stable")]),e._v(" 镜像仓库。您始终需要使用 "),r("strong",[e._v("stable")]),e._v(" 镜像仓库，即使您还需要通过 "),r("strong",[e._v("edge")]),e._v(" 或 "),r("strong",[e._v("testing")]),e._v(" 镜像仓库安装构建也是如此。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br")])]),r("p",[r("strong",[e._v("可选")]),e._v("：启用 "),r("strong",[e._v("edge")]),e._v(" 和 "),r("strong",[e._v("testing")]),e._v(" 镜像仓库。这些镜像仓库包含在上述 "),r("code",[e._v("docker.repo")]),e._v(" 文件中，但默认情况下处于禁用状态。您可以将它们与 stable 镜像仓库一起启用。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum-config-manager --enable docker-ce-edge\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum-config-manager --enable docker-ce-testing\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("您可以通过运行带有 "),r("code",[e._v("--disable")]),e._v(" 标志的 "),r("code",[e._v("yum-config-manager")]),e._v(" 命令来禁用 "),r("strong",[e._v("edge")]),e._v(" 或 "),r("strong",[e._v("testing")]),e._v(" 镜像仓库。如需将其重新启用，请使用"),r("code",[e._v("--enable")]),e._v(" 标志。以下命令用于禁用 "),r("strong",[e._v("edge")]),e._v(" 镜像仓库。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum-config-manager --disable docker-ce-edge\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("blockquote",[r("p",[r("strong",[e._v("注")]),e._v("：从 Docker 17.06 开始，还会将 stable 版本推送到 "),r("strong",[e._v("edge")]),e._v(" 和 "),r("strong",[e._v("testing")]),e._v(" 镜像仓库。")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/",target:"_blank",rel:"noopener noreferrer"}},[e._v("了解 "),r("strong",[e._v("stable")]),e._v(" 和 "),r("strong",[e._v("edge")]),e._v(" 构建"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("ol",{attrs:{start:"2"}},[r("li",[e._v("安装 DOCKER CE")])]),e._v(" "),r("p",[e._v("更新 "),r("code",[e._v("yum")]),e._v(" 软件包索引。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum makecache fast\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("如果这是自添加 Docker 镜像仓库以来您首次刷新软件包索引，系统将提示您接受 GPG 密钥，并且将显示此密钥的指纹。验证指纹是否正确，并且在正确的情况下接受此密钥。指纹应匹配 "),r("code",[e._v("060A 61C5 1B55 8A7F 742B 77AA C52F EB6B 621E 9F35")]),e._v("。")]),e._v(" "),r("p",[e._v("安装最新版本的 Docker CE，或者转至下一步以安装特定版本。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum install docker-ce\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("blockquote",[r("p",[r("strong",[e._v("警告")]),e._v("：如果您启用了多个 Docker 镜像仓库，进行安装 或者更新而不在 "),r("code",[e._v("yum install")]),e._v(" 或 "),r("code",[e._v("yum update")]),e._v(" 命令中指定版本将始终安装可用的最高版本， 这可能无法满足您的稳定性需求。")])]),e._v(" "),r("p",[e._v("在生产系统中，您应该安装特定版本的 Docker CE，而不是始终使用最新版本。列出可用版本。此示例使用 "),r("code",[e._v("sort -r")]),e._v(" 命令按版本号（从最高到最低）对结果进行排序，并且已被截断。")]),e._v(" "),r("blockquote",[r("p",[r("strong",[e._v("注")]),e._v("：此 "),r("code",[e._v("yum list")]),e._v(" 命令仅显示二进制软件包。如果还需要显示 源软件包，请从软件包名称中省略 "),r("code",[e._v(".x86_64")]),e._v("。")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ yum list docker-ce.x86_64  --showduplicates | sort -r\n\ndocker-ce.x86_64  17.06.0.el7                               docker-ce-stable  \n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br")])]),r("p",[e._v("此列表的内容取决于启用了哪些镜像仓库，并且将特定于您的 CentOS 版本（在本示例中，由版本中的 "),r("code",[e._v(".el7")]),e._v(" 后缀表示）。选择一个特定版本进行安装。第二列为版本字符串。第三列为镜像仓库名称，它表示软件包来自哪个镜像仓库并按扩展其稳定性级别列出。如需安装特定版本，请将版本字符串附加到软件包名称，并使用连字符 ("),r("code",[e._v("-")]),e._v(") 分隔它们：")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum install docker-ce-<VERSION>\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("启动 Docker。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo systemctl start docker\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("验证是否正确安装了 "),r("code",[e._v("docker")]),e._v("，方法是运行 "),r("code",[e._v("hello-world")]),e._v(" 镜像。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo docker run hello-world\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("此命令将下载一个测试镜像并在容器中运行它。容器运行时，它将输出一条参考消息并退出。")]),e._v(" "),r("p",[e._v("Docker CE 已安装并且正在运行。您需要使用 "),r("code",[e._v("sudo")]),e._v(" 运行 Docker 命令。继续执行 "),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/linux-postinstall/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Linux 安装后步骤"),r("OutboundLink")],1),e._v("以允许非特权用户运行 Docker 命令，以及了解其他可选配置步骤。")]),e._v(" "),r("ol",{attrs:{start:"3"}},[r("li",[e._v("升级 DOCKER CE")])]),e._v(" "),r("p",[e._v("如需升级 Docker CE，首先运行 "),r("code",[e._v("sudo yum makecache fast")]),e._v("，然后按照"),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#install-docker",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装说明"),r("OutboundLink")],1),e._v("执行操作，并选择您要安装的新版本。")]),e._v(" "),r("h3",{attrs:{id:"_3-2-从软件包进行安装"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-从软件包进行安装"}},[e._v("#")]),e._v(" 3.2. 从软件包进行安装")]),e._v(" "),r("p",[e._v("如果您无法使用 Docker 镜像仓库安装 Docker，可以下载适用于您的版本的 "),r("code",[e._v(".rpm")]),e._v(" 文件，并手动进行安装。每次要升级 Docker 时，您都需要下载一个新文件。")]),e._v(" "),r("p",[e._v("1.转至 "),r("a",{attrs:{href:"https://download.docker.com/linux/centos/7/x86_64/stable/Packages/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://download.docker.com/linux/centos/7/x86_64/stable/Packages/"),r("OutboundLink")],1),e._v(" 并下载适用于您要安装的 Docker 版本的 "),r("code",[e._v(".rpm")]),e._v(" 文件。")]),e._v(" "),r("blockquote",[r("p",[r("strong",[e._v("注")]),e._v("：如需安装 "),r("strong",[e._v("edge")]),e._v(" 软件包，请将 URL 中的词 "),r("code",[e._v("stable")]),e._v(" 更改为 "),r("code",[e._v("edge")]),e._v("。 "),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/",target:"_blank",rel:"noopener noreferrer"}},[e._v("了解 "),r("strong",[e._v("stable")]),e._v(" 和 "),r("strong",[e._v("edge")]),e._v(" 渠道"),r("OutboundLink")],1),e._v("。")])]),e._v(" "),r("p",[e._v("2.安装 Docker CE，并将下面的路径更改为您下载 Docker 软件包的路径。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum install /path/to/package.rpm\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("3.启动 Docker。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo systemctl start docker\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("4.验证是否正确安装了 "),r("code",[e._v("docker")]),e._v("，方法是运行 "),r("code",[e._v("hello-world")]),e._v(" 镜像。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo docker run hello-world\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("此命令将下载一个测试镜像并在容器中运行它。容器运行时，它将输出一条参考消息并退出。")]),e._v(" "),r("p",[e._v("Docker CE 已安装并且正在运行。您需要使用 "),r("code",[e._v("sudo")]),e._v(" 运行 Docker 命令。继续执行 "),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/linux-postinstall/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Linux 的安装后步骤"),r("OutboundLink")],1),e._v("以允许非特权用户运行 Docker 命令，以及了解其他可选配置步骤。")]),e._v(" "),r("h3",{attrs:{id:"_3-3-升级-docker-ce"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-升级-docker-ce"}},[e._v("#")]),e._v(" 3.3. 升级 DOCKER CE")]),e._v(" "),r("p",[e._v("如需升级 Docker CE，请下载较新的软件包文件并重复"),r("a",{attrs:{href:"https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#install-from-a-package",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装过程"),r("OutboundLink")],1),e._v("，使用 "),r("code",[e._v("yum -y upgrade")]),e._v(" 而不是 "),r("code",[e._v("yum -y install")]),e._v(" 并指向新文件。")]),e._v(" "),r("h2",{attrs:{id:"_4-卸载-docker-ce"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-卸载-docker-ce"}},[e._v("#")]),e._v(" 4. 卸载 Docker CE")]),e._v(" "),r("p",[e._v("1.卸载 Docker 软件包：")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo yum remove docker-ce\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("2.主机上的镜像、容器、存储卷、或定制配置文件不会自动删除。如需删除所有镜像、容器和存储卷，请运行下列命令：")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("$ sudo rm -rf /var/lib/docker\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("您必须手动删除任何已编辑的配置文件。")])])}),[],!1,null,null,null);s.default=a.exports}}]);